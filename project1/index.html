<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>CS180 — Project 1: Colorizing the Prokudin-Gorskii Photo Collection</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        h1 { text-align: center; }
        .container { margin: 0 auto; padding: 60px 20%; }
        figure { text-align: center; }
        img { display: inline-block; max-width: 100%; height: auto; }
        body { font-family: 'Inter', sans-serif; }
        code { background-color: #f2f2f2; padding: 2px 4px; border-radius: 4px; font-family: monospace; }
        summary {
            cursor: pointer; padding: 8px; background-color: #f2f2f2; border: 1px solid #ccc;
            border-radius: 6px; padding-left: 12px; position: relative;
        }
        details { margin-bottom: 12px; }
        table {
            width: 100%; border-collapse: separate; border-spacing: 0; margin-bottom: 40px;
            border: 1px solid #ccc; border-radius: 12px; overflow: hidden;
        }
        th, td { border: none; padding: 12px; text-align: left; vertical-align: top; }
        th { background-color: #fadee0; }
        ul.resources li { margin-bottom: 8px; }
        td.date-column { width: 220px; background-color: #fadee0; }
        .week-header { background-color: #fadee0; font-weight: bold; font-size: 1.1em; }
        .subheader-box {
            background-color: #f2f2f2; border-left: 4px solid #444; padding: 10px 16px;
            margin: 1em 0; border-radius: 6px; font-weight: 600;
        }
        .question-box {
            padding: 10px 16px; margin: 1em 0; border-radius: 6px; font-weight: 600;
            color: #8b0000; background-color: #fce4e4;
        }
        .gallery-2 {
            display: grid; grid-template-columns: 1fr; gap: 12px; margin: 10px 0;
        }
        @media (min-width: 900px) { .gallery-2 { grid-template-columns: 1fr 1fr; } }
        .caption { text-align: center; margin-top: 10px; color: #555; }
        .top-banner {
            display: flex; justify-content: center; gap: 40px; margin: 1.5em 0 3em 0;
            font-weight: 600; font-size: 1rem;
        }
        .top-banner a:link { color: #8b0000; text-decoration: none; padding: 8px 16px; border-radius: 8px; transition: background-color 0.3s ease; }
        .top-banner a:visited { color: #ec7699; }
        .top-banner a:hover { color: #ec7699; background-color: #fce4e4; animation: jello 1.5s ease-in-out infinite; }
        .top-banner a:active { color: #8b0000; }
        .top-banner a:focus { outline: none; background-color: #fce4e4; }
        a:link { color: #8b0000; } a:visited { color: #ec7699; } a:hover { color: #ec7699; } a:active { color: #8b0000; }
        @keyframes jello {
            0% { transform: none; }
            15% { transform: skewX(-12deg) skewY(-12deg); }
            30% { transform: skewX(6deg) skewY(6deg); }
            45% { transform: skewX(-3deg) skewY(-3deg); }
            60% { transform: skewX(1deg) skewY(1deg); }
            75% { transform: skewX(-0.5deg) skewY(-0.5deg); }
            100% { transform: none; }
        }
        @media print {
            a[href^="file://"], .MathJax_Message, .mjx-chtml, .MathJax { display: none !important; }
            a::after { content: "" !important; }
            @page { margin: 1in 1in; }
            .container { margin: 0 auto; padding: 0 0; }
            code { background-color: #fadee0; padding: 2px 4px; border-radius: 4px; font-family: monospace; tab-size: 2; }
            pre code { white-space: pre-wrap !important; overflow-x: visible !important; max-width: 100% !important; }
        }

        /* ⬇ NEW: make all preview images inside result tables the same size */
        .results-table td img {
            width: 260px;      /* adjust as you like */
            height: 180px;     /* adjust as you like */
            object-fit: cover; /* keeps uniform size by cropping if needed */
            border-radius: 6px;
            display: block;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>CS180 Project 1: Colorizing the Prokudin-Gorskii Photo Collection</h1>
    <h2 style="text-align:center">UC Berkeley • Fall 2025</h2>
    <h3 style="text-align:center">Nandini Velinedi</h3>

    <div class="top-banner">
      <a href="https://nanvelinedi.github.io/project1/" target="_blank" rel="noopener">Website</a>
      <a href="../index.html">← Back to Portfolio</a>
    </div>

    <h2>Overview</h2>
    <div class="subheader-box">
        Goal: align the three grayscale scans (B, G, R) of each glass plate to reconstruct color photographs.
    </div>
    <p>
        For this project, I implemented an automatic image alignment algorithm to colorize the Prokudin-Gorskii glass plate photographs.
        These historical images were taken by Russian photographer Sergei Prokudin-Gorskii in the early 1900s using three separate exposures
        through blue, green, and red color filters. The goal is to computationally align these three black-and-white images to recreate the
        original color photographs.
    </p>

    <h2>My approach</h2>
    <p>
        I implemented two main algorithms for aligning the color channels. For smaller images, I used exhaustive search over a displacement
        window of [-15, 15] pixels, splitting the input into three equal parts and using the blue channel as reference while aligning green
        and red to it using Sum of Squared Differences (SSD). For large .tif files where exhaustive search becomes too slow, I implemented
        an image pyramid approach that builds a pyramid by downsampling images by factors of 2, starts alignment at the coarsest level, and
        scales displacements up by 2x at each level until reaching full resolution. I also implemented multiple alignment metrics including
        Normalized Cross-Correlation and edge-based correlation using Sobel operators, which proved crucial for images with different brightness
        levels between channels.
    </p>

    <h2>Results</h2>
    <table class="results-table">
      <thead>
        <tr>
          <th>Image</th>
          <th>Preview</th>
          <th>Green displacement</th>
          <th>Red displacement</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Tobolsk</td><td><img src="tobolsk_aligned.jpg" alt="Tobolsk"></td><td>(3, 3)</td><td>(3, 6)</td></tr>
        <tr><td>Church</td><td><img src="church_aligned.jpg" alt="Church"></td><td>(4, 25)</td><td>(-4, 58)</td></tr>
        <tr><td>Cathedral</td><td><img src="cathedral_aligned.jpg" alt="Cathedral"></td><td>(2, 5)</td><td>(3, 12)</td></tr>
        <tr><td>Emir</td><td><img src="emir_aligned.jpg" alt="Emir"></td><td>(0, 0)</td><td>(0, 0)</td></tr>
        <tr><td>Three Generations</td><td><img src="three_generations_aligned.jpg" alt="Three Generations"></td><td>(14, 53)</td><td>(11, 112)</td></tr>
        <tr><td>Harvesters</td><td><img src="harvesters_aligned.jpg" alt="Harvesters"></td><td>(17, 60)</td><td>(13, 124)</td></tr>
        <tr><td>Icon</td><td><img src="icon_aligned.jpg" alt="Icon"></td><td>(17, 41)</td><td>(23, 89)</td></tr>
        <tr><td>Italil</td><td><img src="italil_aligned.jpg" alt="Italil"></td><td>(21, 38)</td><td>(35, 76)</td></tr>
        <tr><td>Lastochikino</td><td><img src="lastochikino_aligned.jpg" alt="Lastochikino"></td><td>(-2, -3)</td><td>(-9, 75)</td></tr>
        <tr><td>Lugano</td><td><img src="lugano_aligned.jpg" alt="Lugano"></td><td>(-16, 41)</td><td>(-29, 93)</td></tr>
        <tr><td>Self Portrait</td><td><img src="self_portrait_aligned.jpg" alt="Self Portrait"></td><td>(29, 79)</td><td>(33, 156)</td></tr>
        <tr><td>Siren</td><td><img src="siren_aligned.jpg" alt="Siren"></td><td>(-6, 49)</td><td>(-25, 96)</td></tr>
        <tr><td>Melons</td><td><img src="melons_aligned.jpg" alt="Melons"></td><td>(11, 82)</td><td>(12, 156)</td></tr>
      </tbody>
    </table>

    <h3>Examples from Prokudin-Gorskii Collection</h3>
    <table class="results-table">
      <thead>
        <tr>
          <th>Image</th>
          <th>Preview</th>
          <th>Green displacement</th>
          <th>Red displacement</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Camel</td><td><img src="camel_aligned.jpg" alt="Camel"></td><td>(0, 5)</td><td>(-2, 10)</td></tr>
        <tr><td>Landscape</td><td><img src="landscape_aligned.jpg" alt="Landscape"></td><td>(1, -3)</td><td>(1, -4)</td></tr>
        <tr><td>Peony</td><td><img src="peony_aligned.jpg" alt="Peony"></td><td>(2, 8)</td><td>(3, 15)</td></tr>
      </tbody>
    </table>

    <h2>What went wrong</h2>
    <p>
        The Emir of Bukhara remains my biggest challenge, with poor alignment even using the pyramid approach due to extreme brightness
        differences between color channels where the red channel looks way darker, complex patterns on the clothing that create false matches,
        and large displacements that might be outside my search range. The colored borders you see are artifacts from using np.roll() to shift
        the images where pixels that get shifted off one edge wrap around to the other side. A few other images like sculpture and some
        landscapes also show moderate alignment issues, usually due to motion between exposures or large displacement requirements.
    </p>

    <h2>Bells and whistles</h2>
    <p>
        I implemented multiple alignment metrics including Normalized Cross-Correlation and edge-based correlation using Sobel edge detection,
        which helped with images that have different brightness levels between channels. I also added automatic border cropping to remove the
        colored artifacts from np.roll() and smart search range adaptation in the pyramid implementation.
    </p>

    <h2>Conclusion</h2>
    <p>
        The pyramid approach successfully aligns most of the Prokudin-Gorskii images efficiently. While a few challenging cases like the Emir
        remain problematic, the overall results demonstrate how computational techniques can bring these historical color photographs back to life.
        It’s pretty amazing to see 100+ year old color photography recreated through image alignment algorithms!
    </p>
</div>
</body>
</html>
